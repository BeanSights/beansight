<html layout:decorate="~{usr/layout/layout.html}">
<div id="tagContainer" class="flex justify-center flex-col items-center mt-4" th:fragment="tagSelectFragment(tagList)">
  <div class="tags flex w-2/5 my-4 justify-center">
    <button class="tag btn btn-outline btn-warning btn-sm"
            th:each="tag : ${tagList}"
            th:id="${tag.tagId}"
            th:text="${tag.tagName}"></button>
  </div>

  <div id="selectedTagContainer" data-selected-tags="${selectedTagList}"></div>

<script>
  const tagContainer = document.getElementById('tagContainer');
  var selectedBtn = /*[[${selectedTagList}]]*/ [];

  selectedBtn.forEach(function(id) {
    var button = document.getElementById(id);
    button.classList.add('btn-active');
  })

  tagContainer.addEventListener('click', function (e){

    if (e.target.classList.contains('tag')){
      // 버튼 활성화 상태에 따라 count 증감
      if (!e.target.classList.contains('btn-active')) {
        // 이미 5개 선택한 경우
        if (selectedBtn.length >= 5) {
          alert('이미 선호 태그를 최대로 선택하셨습니다!!');
          return;
        }
        e.target.classList.add('btn-active');
        selectedBtn.push(e.target.getAttribute("id"));
      }
      else {
        e.target.classList.remove('btn-active');
        for (var i = 0; i < selectedBtn.length; i++) {
          if (selectedBtn[i] === e.target.getAttribute("id")) {
            selectedBtn.splice(i,1);
            i--;
          }
        }
      }
    }
  });
</script>
</div>
</html>